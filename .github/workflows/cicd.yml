name: Ecommerce Website CICD

on:
    push:
        branches: ['main']
    pull_request:
        branches: ['main']

jobs:
    build_and_push:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout the Code
              uses: actions/checkout@v4

            - name: Login To docker
              uses:  docker/login-action@v3
              with:
                username: ${{vars.DOCKER_USERNAME}}
                password: ${{secrets.DOCKER_TOKEN}}
            
            - name: Build and Push Backend Image
              run: |
                docker build -t ${{vars.DOCKER_USERNAME}}/backend:latest ./backend
                docker push ${{vars.DOCKER_USERNAME}}/backend:latest
            
            - name: Build and Push  Frontend Image
              run: |
                docker build -t ${{vars.DOCKER_USERNAME}}/frontend:latest ./frontend
                docker push ${{vars.DOCKER_USERNAME}}/frontend:latest
